# front-end/preact-client/nginx.conf


server {
    # Listen on the container's port 80
    listen 80;

    # Set the root directory to where our static files are copied
    root /usr/share/nginx/html;

    # Default file to serve
    index index.html;

    # This is the key part for SPAs:
    # It will try to serve the requested file, then a directory,
    # and if neither exists, it will fall back to serving /index.html.
    # This allows the Preact router to handle the request.
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Add cache headers for static assets to improve performance
    # Cache JS and CSS files for 1 year
    location ~* \.(?:css|js)$ {
        expires 1y;
        add_header Cache-Control "public";
    }

    # Cache images, icons, and fonts for 1 month
    location ~* \.(?:ico|gif|jpe?g|png|svg|woff|woff2|ttf|eot)$ {
        expires 1M;
        add_header Cache-Control "public";
    }
}